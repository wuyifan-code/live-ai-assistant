# 🎮 抖音直播小玩法接入指南（个人开发者版）

专为个人开发者设计的抖音直播带货AI助手接入方案！

---

## 📋 目录

1. [快速开始](#-快速开始)
2. [创建直播小玩法应用](#-创建直播小玩法应用)
3. [获取凭证](#-获取凭证)
4. [配置项目](#-配置项目)
5. [功能说明](#-功能说明)
6. [测试和调试](#-测试和调试)

---

## 🚀 快速开始

### 三步即可启用：

1. **创建应用** → 在抖音开放平台创建"直播小玩法"
2. **获取凭证** → 复制 App ID、App Secret、小游戏ID
3. **配置运行** → 填入配置并启动系统

---

## 🛠️ 创建直播小玩法应用

### 第1步：登录抖音开放平台

1. 访问 [https://open.douyin.com/](https://open.douyin.com/)
2. 使用抖音APP扫码登录
3. 点击右上角 **"管理中心"**

### 第2步：进入应用管理

1. 在左侧菜单找到 **"应用管理"**
2. 点击 **"创建应用"** 按钮

### 第3步：选择应用类型

⚠️ **重要**：个人开发者只能选择以下两种之一：

| 类型 | 推荐度 | 说明 |
|------|--------|------|
| **直播小玩法** | ⭐⭐⭐⭐⭐ | **强烈推荐**！支持弹幕互动、消息发送、电商功能 |
| **小程序** | ⭐⭐⭐ | 适合做完整应用，但直播相关功能有限 |

**选择：直播小玩法** ✅

### 第4步：填写应用信息

```
应用名称: 直播带货AI助手
（或其他您喜欢的名字）

应用分类: 电商助手 / 互动工具
（选择最接近的分类）

应用描述: 
智能弹幕回复、商品咨询、主播辅助工具，
帮助提升直播间互动效率和转化率。

应用图标: 上传一个清晰的图标
（建议尺寸：512x512 PNG）
```

### 第5步：提交审核

1. 检查信息填写无误
2. 点击 **"提交审核"**
3. 等待审核结果（通常 **1-3个工作日**）

---

## 🔑 获取凭证

### 审核通过后，进入应用详情页

您会看到以下关键信息：

| 字段名 | 位置 | 说明 |
|--------|------|------|
| **App ID** | 基本信息区域 | 应用唯一标识，类似 `tt1234567890abcdef` |
| **App Secret** | 基本信息区域 | 应用密钥，点击"查看"获取 ⚠️ 仅显示一次！ |
| **小游戏 ID** | 直播小玩法专属 | 格式类似 `game_123456` |

### ⚠️ 重要提醒

1. **立即保存 App Secret**：只显示一次，刷新页面就看不到了！
2. **不要泄露密钥**：App Secret 相当于密码，不要上传到公开代码库
3. **如果忘记了**：点击"重置 Secret"生成新的（旧的会失效）

---

## ⚙️ 配置项目

### 方式一：环境变量（推荐）

#### Linux / macOS

打开终端，运行：

```bash
export DOUYIN_APP_ID="您的AppID"
export DOUYIN_APP_SECRET="您的AppSecret"
export DOUYIN_MINI_GAME_ID="您的小游戏ID"
```

#### Windows

打开命令提示符（CMD），运行：

```cmd
set DOUYIN_APP_ID=您的AppID
set DOUYIN_APP_SECRET=您的AppSecret
set DOUYIN_MINI_GAME_ID=您的小游戏ID
```

### 方式二：修改配置文件

编辑 `src/integrations/douyin_mini_game_api.py`：

```python
class DouyinMiniGameAPI:
    def __init__(self):
        self.app_id = os.getenv("DOUYIN_APP_ID", "在这里填入您的AppID")
        self.app_secret = os.getenv("DOUYIN_APP_SECRET", "在这里填入您的AppSecret")
        self.mini_game_id = os.getenv("DOUYIN_MINI_GAME_ID", "在这里填入您的小游戏ID")
```

### 方式三：创建 .env 文件

在项目根目录创建 `.env` 文件：

```env
DOUYIN_APP_ID=您的AppID
DOUYIN_APP_SECRET=您的AppSecret
DOUYIN_MINI_GAME_ID=您的小游戏ID
```

---

## 🎯 功能说明

### 直播小玩法支持的功能

| 功能 | 状态 | 说明 |
|------|------|------|
| ✅ **实时弹幕获取** | 已支持 | 获取直播间弹幕消息 |
| ✅ **弹幕消息发送** | 已支持 | 发送AI回复到直播间 |
| ✅ **礼物消息获取** | 已支持 | 获取送礼记录 |
| ✅ **商品列表获取** | 已支持 | 获取直播间商品 |
| ✅ **商品卡片推送** | 已支持 | 推送商品卡片 |
| ✅ **直播间信息查询** | 已支持 | 获取直播间状态 |

---

## 🧪 测试和调试

### 第1步：测试API连接

运行测试脚本：

```bash
python -m src.douyin_mini_game_test
```

### 第2步：模拟模式开发

在开发阶段，可以使用模拟版本，无需真实API：

```python
from integrations.douyin_mini_game_api import MockDouyinMiniGameAPI

# 使用模拟API
api = MockDouyinMiniGameAPI()

# 测试功能
await api.get_room_info("test_room")
await api.send_message("test_room", "大家好！")
```

### 第3步：联调测试

配置好真实凭证后，进行实际测试：

1. 开启一个测试直播间
2. 获取直播间ID
3. 运行系统进行测试

---

## 📝 常见问题

### Q1: 审核需要多久？

通常 **1-3个工作日**，快的话当天就能通过。

### Q2: 审核被拒绝怎么办？

常见原因和解决方案：

| 拒绝原因 | 解决方案 |
|---------|---------|
| 应用描述不清晰 | 详细说明功能、使用场景、对用户的价值 |
| 图标不规范 | 使用清晰、无文字、符合尺寸要求的图标 |
| 分类选择错误 | 重新选择更合适的分类 |
| 缺少资质证明 | 个人开发者通常不需要额外资质 |

### Q3: App Secret 忘了怎么办？

在应用详情页点击 **"重置 Secret"**：
- 会生成新的密钥
- 旧的密钥立即失效
- 记得更新项目配置！

### Q4: 直播间ID怎么获取？

有几种方式：

1. **直播间分享链接**：
   - 分享直播间 → 复制链接
   - 链接中包含房间ID

2. **主播后台查看**：
   - 在抖音主播后台可以看到

3. **使用调试工具**：
   - 使用抖音开发者工具获取

### Q5: 支持多个直播间吗？

支持！同一个应用可以绑定多个直播间。

---

## 🔗 相关资源

- [抖音开放平台官网](https://open.douyin.com/)
- [直播小玩法文档](https://developer.open-douyin.com/docs/resource/zh-CN/mini-game/)
- [API参考文档](https://developer.open-douyin.com/docs/resource/zh-CN/mini-game/develop/server/api)

---

## 💡 下一步

1. ✅ 阅读完本指南
2. 🎯 去抖音开放平台创建应用
3. 🔑 获取并配置凭证
4. 🚀 运行系统测试

需要帮助？随时询问！
